2025-05-17 15:50:40,273 - INFO - Database connection established and table created.
2025-05-17 15:50:40,276 - INFO - Initialized chunked reading of C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\healthcare_dataset.csv with chunksize 10000
2025-05-17 15:50:40,380 - INFO - Transforming chunk with 10000 records
2025-05-17 15:50:40,391 - INFO - Removed 0 duplicate rows in chunk
2025-05-17 15:50:40,399 - INFO - Standardized column names in chunk
2025-05-17 15:50:40,403 - INFO - Validated/converted name to <class 'str'> in chunk
2025-05-17 15:50:40,404 - INFO - Validated/converted age to Int32 in chunk
2025-05-17 15:50:40,412 - INFO - Validated/converted gender to <class 'str'> in chunk
2025-05-17 15:50:40,414 - INFO - Validated/converted blood_type to <class 'str'> in chunk
2025-05-17 15:50:40,416 - INFO - Validated/converted medical_condition to <class 'str'> in chunk
2025-05-17 15:50:40,422 - INFO - Validated/converted date_of_admission to datetime64[ns] in chunk
2025-05-17 15:50:40,424 - INFO - Validated/converted doctor to <class 'str'> in chunk
2025-05-17 15:50:40,426 - INFO - Validated/converted hospital to <class 'str'> in chunk
2025-05-17 15:50:40,427 - INFO - Validated/converted insurance_provider to <class 'str'> in chunk
2025-05-17 15:50:40,428 - INFO - Validated/converted billing_amount to <class 'float'> in chunk
2025-05-17 15:50:40,428 - INFO - Validated/converted room_number to Int32 in chunk
2025-05-17 15:50:40,430 - INFO - Validated/converted admission_type to <class 'str'> in chunk
2025-05-17 15:50:40,439 - INFO - Validated/converted discharge_date to datetime64[ns] in chunk
2025-05-17 15:50:40,441 - INFO - Validated/converted medication to <class 'str'> in chunk
2025-05-17 15:50:40,443 - INFO - Validated/converted test_results to <class 'str'> in chunk
2025-05-17 15:50:40,447 - INFO - Standardized gender values in chunk
2025-05-17 15:50:40,449 - INFO - Standardized blood_type values in chunk
2025-05-17 15:50:40,451 - INFO - Standardized medical_condition values in chunk
2025-05-17 15:50:40,453 - INFO - Standardized test_results values in chunk
2025-05-17 15:50:40,461 - INFO - Removed titles from name column in chunk
2025-05-17 15:50:40,486 - INFO - Added unique record_id column to chunk
2025-05-17 15:50:40,677 - INFO - Loaded 10000 records into SQLite database
2025-05-17 15:50:40,677 - INFO - Processed and loaded chunk. Total records processed: 10000
2025-05-17 15:50:40,677 - INFO - ETL pipeline completed successfully. Total records: 10000
2025-05-17 15:50:40,678 - INFO - Database connection closed
2025-05-19 20:25:27,685 - INFO - Database connection established and table created.
2025-05-19 20:25:27,691 - INFO - Initialized chunked reading of C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\healthcare_dataset.csv with chunksize 10000
2025-05-19 20:25:27,801 - INFO - Transforming chunk with 10000 records
2025-05-19 20:25:27,823 - INFO - Removed 0 duplicate rows in chunk
2025-05-19 20:25:27,831 - INFO - Standardized column names in chunk
2025-05-19 20:25:27,833 - INFO - Validated/converted name to <class 'str'> in chunk
2025-05-19 20:25:27,837 - INFO - Validated/converted age to Int32 in chunk
2025-05-19 20:25:27,839 - INFO - Validated/converted gender to <class 'str'> in chunk
2025-05-19 20:25:27,840 - INFO - Validated/converted blood_type to <class 'str'> in chunk
2025-05-19 20:25:27,842 - INFO - Validated/converted medical_condition to <class 'str'> in chunk
2025-05-19 20:25:27,849 - INFO - Validated/converted date_of_admission to datetime64[ns] in chunk
2025-05-19 20:25:27,851 - INFO - Validated/converted doctor to <class 'str'> in chunk
2025-05-19 20:25:27,853 - INFO - Validated/converted hospital to <class 'str'> in chunk
2025-05-19 20:25:27,855 - INFO - Validated/converted insurance_provider to <class 'str'> in chunk
2025-05-19 20:25:27,855 - INFO - Validated/converted billing_amount to <class 'float'> in chunk
2025-05-19 20:25:27,856 - INFO - Validated/converted room_number to Int32 in chunk
2025-05-19 20:25:27,858 - INFO - Validated/converted admission_type to <class 'str'> in chunk
2025-05-19 20:25:27,864 - INFO - Validated/converted discharge_date to datetime64[ns] in chunk
2025-05-19 20:25:27,866 - INFO - Validated/converted medication to <class 'str'> in chunk
2025-05-19 20:25:27,867 - INFO - Validated/converted test_results to <class 'str'> in chunk
2025-05-19 20:25:27,870 - INFO - Standardized gender values in chunk
2025-05-19 20:25:27,872 - INFO - Standardized blood_type values in chunk
2025-05-19 20:25:27,874 - INFO - Standardized medical_condition values in chunk
2025-05-19 20:25:27,876 - INFO - Standardized test_results values in chunk
2025-05-19 20:25:27,883 - INFO - Removed titles from name column in chunk
2025-05-19 20:25:27,911 - INFO - Added unique record_id column to chunk
2025-05-19 20:25:28,675 - INFO - Loaded 10000 records into SQLite database
2025-05-19 20:25:28,675 - INFO - Processed and loaded chunk. Total records processed: 10000
2025-05-19 20:25:28,676 - INFO - ETL pipeline completed successfully. Total records: 10000
2025-05-19 20:25:28,676 - INFO - Database connection closed
2025-05-19 20:25:43,295 - INFO - Database connection established and table created.
2025-05-19 20:25:43,299 - INFO - Initialized chunked reading of C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\healthcare_dataset.csv with chunksize 10000
2025-05-19 20:25:43,408 - INFO - Transforming chunk with 10000 records
2025-05-19 20:25:43,420 - INFO - Removed 0 duplicate rows in chunk
2025-05-19 20:25:43,428 - INFO - Standardized column names in chunk
2025-05-19 20:25:43,430 - INFO - Validated/converted name to <class 'str'> in chunk
2025-05-19 20:25:43,431 - INFO - Validated/converted age to Int32 in chunk
2025-05-19 20:25:43,433 - INFO - Validated/converted gender to <class 'str'> in chunk
2025-05-19 20:25:43,436 - INFO - Validated/converted blood_type to <class 'str'> in chunk
2025-05-19 20:25:43,438 - INFO - Validated/converted medical_condition to <class 'str'> in chunk
2025-05-19 20:25:43,444 - INFO - Validated/converted date_of_admission to datetime64[ns] in chunk
2025-05-19 20:25:43,446 - INFO - Validated/converted doctor to <class 'str'> in chunk
2025-05-19 20:25:43,448 - INFO - Validated/converted hospital to <class 'str'> in chunk
2025-05-19 20:25:43,449 - INFO - Validated/converted insurance_provider to <class 'str'> in chunk
2025-05-19 20:25:43,451 - INFO - Validated/converted billing_amount to <class 'float'> in chunk
2025-05-19 20:25:43,452 - INFO - Validated/converted room_number to Int32 in chunk
2025-05-19 20:25:43,454 - INFO - Validated/converted admission_type to <class 'str'> in chunk
2025-05-19 20:25:43,460 - INFO - Validated/converted discharge_date to datetime64[ns] in chunk
2025-05-19 20:25:43,462 - INFO - Validated/converted medication to <class 'str'> in chunk
2025-05-19 20:25:43,464 - INFO - Validated/converted test_results to <class 'str'> in chunk
2025-05-19 20:25:43,469 - INFO - Standardized gender values in chunk
2025-05-19 20:25:43,472 - INFO - Standardized blood_type values in chunk
2025-05-19 20:25:43,474 - INFO - Standardized medical_condition values in chunk
2025-05-19 20:25:43,476 - INFO - Standardized test_results values in chunk
2025-05-19 20:25:43,485 - INFO - Removed titles from name column in chunk
2025-05-19 20:25:43,511 - INFO - Added unique record_id column to chunk
2025-05-19 20:25:43,789 - INFO - Loaded 10000 records into SQLite database
2025-05-19 20:25:43,789 - INFO - Processed and loaded chunk. Total records processed: 10000
2025-05-19 20:25:43,789 - INFO - ETL pipeline completed successfully. Total records: 10000
2025-05-19 20:25:43,790 - INFO - Database connection closed
2025-05-19 20:26:04,250 - INFO - Database connection established and table created.
2025-05-19 20:26:04,254 - INFO - Initialized chunked reading of C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\healthcare_dataset.csv with chunksize 10000
2025-05-19 20:26:04,360 - INFO - Transforming chunk with 10000 records
2025-05-19 20:26:04,372 - INFO - Removed 0 duplicate rows in chunk
2025-05-19 20:26:04,379 - INFO - Standardized column names in chunk
2025-05-19 20:26:04,381 - INFO - Validated/converted name to <class 'str'> in chunk
2025-05-19 20:26:04,382 - INFO - Validated/converted age to Int32 in chunk
2025-05-19 20:26:04,384 - INFO - Validated/converted gender to <class 'str'> in chunk
2025-05-19 20:26:04,386 - INFO - Validated/converted blood_type to <class 'str'> in chunk
2025-05-19 20:26:04,388 - INFO - Validated/converted medical_condition to <class 'str'> in chunk
2025-05-19 20:26:04,394 - INFO - Validated/converted date_of_admission to datetime64[ns] in chunk
2025-05-19 20:26:04,396 - INFO - Validated/converted doctor to <class 'str'> in chunk
2025-05-19 20:26:04,397 - INFO - Validated/converted hospital to <class 'str'> in chunk
2025-05-19 20:26:04,399 - INFO - Validated/converted insurance_provider to <class 'str'> in chunk
2025-05-19 20:26:04,399 - INFO - Validated/converted billing_amount to <class 'float'> in chunk
2025-05-19 20:26:04,400 - INFO - Validated/converted room_number to Int32 in chunk
2025-05-19 20:26:04,402 - INFO - Validated/converted admission_type to <class 'str'> in chunk
2025-05-19 20:26:04,408 - INFO - Validated/converted discharge_date to datetime64[ns] in chunk
2025-05-19 20:26:04,409 - INFO - Validated/converted medication to <class 'str'> in chunk
2025-05-19 20:26:04,411 - INFO - Validated/converted test_results to <class 'str'> in chunk
2025-05-19 20:26:04,414 - INFO - Standardized gender values in chunk
2025-05-19 20:26:04,416 - INFO - Standardized blood_type values in chunk
2025-05-19 20:26:04,417 - INFO - Standardized medical_condition values in chunk
2025-05-19 20:26:04,419 - INFO - Standardized test_results values in chunk
2025-05-19 20:26:04,427 - INFO - Removed titles from name column in chunk
2025-05-19 20:26:04,452 - INFO - Added unique record_id column to chunk
2025-05-19 20:26:04,732 - INFO - Loaded 10000 records into SQLite database
2025-05-19 20:26:04,732 - INFO - Processed and loaded chunk. Total records processed: 10000
2025-05-19 20:26:04,733 - INFO - ETL pipeline completed successfully. Total records: 10000
2025-05-19 20:26:04,734 - INFO - Database connection closed
2025-05-19 21:28:07,677 - INFO - Initialized HealthcareETL with CSV: C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\test_healthcare_dataset.csv, DB: healthcare.db, Chunksize: 10000
2025-05-19 21:28:07,681 - INFO - Extracted CSV iterator for C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\test_healthcare_dataset.csv
2025-05-19 21:28:07,696 - INFO - Processing chunk 1
2025-05-19 21:28:07,711 - INFO - Removed 0 duplicates
2025-05-19 21:28:07,716 - INFO - Handled missing values
2025-05-19 21:28:07,719 - INFO - Standardized formats
2025-05-19 21:28:07,722 - INFO - Validated data
2025-05-19 21:28:07,730 - INFO - Connected to database: healthcare.db
2025-05-19 21:28:07,740 - ERROR - Load failed: table healthcare has no column named Blood Type
2025-05-19 21:28:07,740 - ERROR - ETL pipeline failed: table healthcare has no column named Blood Type
2025-05-19 21:28:07,740 - INFO - Database connection closed
2025-05-19 21:29:57,866 - INFO - Initialized HealthcareETL with CSV: test_healthcare_dataset.csv, DB: test_healthcare.db, Chunksize: 2
2025-05-19 21:29:57,866 - INFO - Test setup completed.
2025-05-19 21:29:57,866 - INFO - Connected to database successfully.
2025-05-19 21:29:57,873 - INFO - Doctors table created or already exists.
2025-05-19 21:29:57,878 - INFO - Inserted 5 records into doctors table.
2025-05-19 21:29:57,884 - INFO - Doctors table contents verified.
2025-05-19 21:29:57,884 - INFO - Database connection closed.
2025-05-19 21:29:57,886 - INFO - Doctors table setup test passed.
2025-05-19 21:29:57,887 - INFO - Test database test_healthcare.db deleted.
2025-05-19 21:29:57,887 - INFO - Test teardown completed.
2025-05-19 21:29:57,887 - INFO - Initialized HealthcareETL with CSV: test_healthcare_dataset.csv, DB: test_healthcare.db, Chunksize: 2
2025-05-19 21:29:57,887 - INFO - Test setup completed.
2025-05-19 21:29:57,889 - INFO - Initialized HealthcareETL with CSV: empty_test.csv, DB: test_healthcare.db, Chunksize: 10000
2025-05-19 21:29:57,911 - INFO - Extracted CSV iterator for empty_test.csv
2025-05-19 21:29:57,912 - INFO - Processing chunk 1
2025-05-19 21:29:57,912 - INFO - Removed 0 duplicates
2025-05-19 21:29:57,915 - INFO - Handled missing values
2025-05-19 21:29:57,916 - INFO - Standardized formats
2025-05-19 21:29:57,921 - INFO - Validated data
2025-05-19 21:29:57,922 - INFO - Connected to database: test_healthcare.db
2025-05-19 21:29:57,931 - INFO - Loaded 0 records into healthcare table
2025-05-19 21:29:57,932 - INFO - ETL pipeline completed successfully
2025-05-19 21:29:57,932 - INFO - Database connection closed
2025-05-19 21:29:57,935 - INFO - Empty CSV test passed.
2025-05-19 21:29:57,935 - INFO - Test database test_healthcare.db deleted.
2025-05-19 21:29:57,935 - INFO - Test teardown completed.
2025-05-19 21:29:57,936 - INFO - Initialized HealthcareETL with CSV: test_healthcare_dataset.csv, DB: test_healthcare.db, Chunksize: 2
2025-05-19 21:29:57,936 - INFO - Test setup completed.
2025-05-19 21:29:57,936 - INFO - Extracted CSV iterator for test_healthcare_dataset.csv
2025-05-19 21:29:57,944 - INFO - Processing chunk 1
2025-05-19 21:29:57,946 - INFO - Removed 0 duplicates
2025-05-19 21:29:57,952 - INFO - Handled missing values
2025-05-19 21:29:57,955 - INFO - Standardized formats
2025-05-19 21:29:57,957 - INFO - Validated data
2025-05-19 21:29:57,958 - INFO - Connected to database: test_healthcare.db
2025-05-19 21:29:57,971 - INFO - Loaded 2 records into healthcare table
2025-05-19 21:29:57,975 - INFO - Processing chunk 2
2025-05-19 21:29:57,977 - INFO - Removed 0 duplicates
2025-05-19 21:29:57,979 - INFO - Handled missing values
2025-05-19 21:29:57,980 - INFO - Standardized formats
2025-05-19 21:29:57,981 - INFO - Validated data
2025-05-19 21:29:57,988 - INFO - Loaded 2 records into healthcare table
2025-05-19 21:29:57,990 - INFO - ETL pipeline completed successfully
2025-05-19 21:29:57,990 - INFO - Database connection closed
2025-05-19 21:29:57,990 - INFO - ETL pipeline executed successfully.
2025-05-19 21:29:57,992 - ERROR - ETL test failed: Execution failed on sql 'SELECT SUM(CASE WHEN medical_condition IS NULL THEN 1 ELSE 0 END) AS nulls FROM healthcare': no such column: medical_condition
2025-05-19 21:29:57,995 - INFO - Initialized HealthcareETL with CSV: test_healthcare_dataset.csv, DB: test_healthcare.db, Chunksize: 2
2025-05-19 21:29:57,995 - INFO - Test setup completed.
2025-05-19 21:29:57,995 - INFO - Extracted CSV iterator for test_healthcare_dataset.csv
2025-05-19 21:29:57,997 - INFO - Processing chunk 1
2025-05-19 21:29:57,999 - INFO - Removed 0 duplicates
2025-05-19 21:29:58,002 - INFO - Handled missing values
2025-05-19 21:29:58,003 - INFO - Standardized formats
2025-05-19 21:29:58,004 - INFO - Validated data
2025-05-19 21:29:58,005 - INFO - Connected to database: test_healthcare.db
2025-05-19 21:29:58,010 - INFO - Loaded 2 records into healthcare table
2025-05-19 21:29:58,012 - INFO - Processing chunk 2
2025-05-19 21:29:58,013 - INFO - Removed 0 duplicates
2025-05-19 21:29:58,015 - INFO - Handled missing values
2025-05-19 21:29:58,016 - INFO - Standardized formats
2025-05-19 21:29:58,017 - INFO - Validated data
2025-05-19 21:29:58,023 - INFO - Loaded 2 records into healthcare table
2025-05-19 21:29:58,023 - INFO - ETL pipeline completed successfully
2025-05-19 21:29:58,023 - INFO - Database connection closed
2025-05-19 21:29:58,024 - INFO - Connected to database successfully.
2025-05-19 21:29:58,028 - INFO - Doctors table created or already exists.
2025-05-19 21:29:58,033 - INFO - Inserted 5 records into doctors table.
2025-05-19 21:29:58,035 - INFO - Doctors table contents verified.
2025-05-19 21:29:58,036 - INFO - Database connection closed.
2025-05-19 21:29:58,038 - INFO - Connected to database successfully.
2025-05-19 21:29:58,040 - ERROR - Error: Execution failed on sql '
        SELECT medical_condition, ROUND(AVG(billing_amount), 2) AS average_billing
        FROM healthcare
        GROUP BY medical_condition
        ORDER BY average_billing DESC;
        ': no such column: medical_condition
2025-05-19 21:29:58,041 - INFO - Database connection closed.
2025-05-19 21:29:58,041 - ERROR - GROUP BY test failed: Execution failed on sql '
        SELECT medical_condition, ROUND(AVG(billing_amount), 2) AS average_billing
        FROM healthcare
        GROUP BY medical_condition
        ORDER BY average_billing DESC;
        ': no such column: medical_condition
2025-05-19 21:29:58,044 - INFO - Initialized HealthcareETL with CSV: test_healthcare_dataset.csv, DB: test_healthcare.db, Chunksize: 2
2025-05-19 21:29:58,044 - INFO - Test setup completed.
2025-05-19 21:29:58,044 - INFO - Extracted CSV iterator for test_healthcare_dataset.csv
2025-05-19 21:29:58,046 - INFO - Processing chunk 1
2025-05-19 21:29:58,047 - INFO - Removed 0 duplicates
2025-05-19 21:29:58,049 - INFO - Handled missing values
2025-05-19 21:29:58,051 - INFO - Standardized formats
2025-05-19 21:29:58,055 - INFO - Validated data
2025-05-19 21:29:58,056 - INFO - Connected to database: test_healthcare.db
2025-05-19 21:29:58,062 - INFO - Loaded 2 records into healthcare table
2025-05-19 21:29:58,066 - INFO - Processing chunk 2
2025-05-19 21:29:58,069 - INFO - Removed 0 duplicates
2025-05-19 21:29:58,071 - INFO - Handled missing values
2025-05-19 21:29:58,072 - INFO - Standardized formats
2025-05-19 21:29:58,073 - INFO - Validated data
2025-05-19 21:29:58,081 - INFO - Loaded 2 records into healthcare table
2025-05-19 21:29:58,081 - INFO - ETL pipeline completed successfully
2025-05-19 21:29:58,081 - INFO - Database connection closed
2025-05-19 21:29:58,083 - INFO - Connected to database successfully.
2025-05-19 21:29:58,083 - INFO - Doctors table created or already exists.
2025-05-19 21:29:58,084 - INFO - Inserted 0 records into doctors table.
2025-05-19 21:29:58,087 - INFO - Doctors table contents verified.
2025-05-19 21:29:58,087 - INFO - Database connection closed.
2025-05-19 21:29:58,088 - INFO - Connected to database successfully.
2025-05-19 21:29:58,090 - ERROR - Error: Execution failed on sql '
        SELECT h.medical_condition, h.doctor, d.specialty, COUNT(*) AS patient_count
        FROM healthcare h
        INNER JOIN doctors d ON h.doctor = d.doctor_name
        GROUP BY h.medical_condition, h.doctor, d.specialty
        ORDER BY patient_count DESC;
        ': no such column: h.medical_condition
2025-05-19 21:29:58,091 - INFO - Database connection closed.
2025-05-19 21:29:58,091 - ERROR - INNER JOIN test failed: Execution failed on sql '
        SELECT h.medical_condition, h.doctor, d.specialty, COUNT(*) AS patient_count
        FROM healthcare h
        INNER JOIN doctors d ON h.doctor = d.doctor_name
        GROUP BY h.medical_condition, h.doctor, d.specialty
        ORDER BY patient_count DESC;
        ': no such column: h.medical_condition
2025-05-19 21:30:17,553 - INFO - Initialized HealthcareETL with CSV: C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\test_healthcare_dataset.csv, DB: healthcare.db, Chunksize: 10000
2025-05-19 21:30:17,554 - INFO - Extracted CSV iterator for C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\test_healthcare_dataset.csv
2025-05-19 21:30:17,559 - INFO - Processing chunk 1
2025-05-19 21:30:17,560 - INFO - Removed 0 duplicates
2025-05-19 21:30:17,562 - INFO - Handled missing values
2025-05-19 21:30:17,563 - INFO - Standardized formats
2025-05-19 21:30:17,565 - INFO - Validated data
2025-05-19 21:30:17,565 - INFO - Connected to database: healthcare.db
2025-05-19 21:30:17,567 - ERROR - Load failed: table healthcare has no column named Blood Type
2025-05-19 21:30:17,567 - ERROR - ETL pipeline failed: table healthcare has no column named Blood Type
2025-05-19 21:30:17,567 - INFO - Database connection closed
2025-05-19 21:30:34,237 - INFO - Initialized HealthcareETL with CSV: C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\test_healthcare_dataset.csv, DB: healthcare.db, Chunksize: 10000
2025-05-19 21:30:34,238 - INFO - Extracted CSV iterator for C:\Users\maruf\OneDrive\Desktop\SQL-Data-Analysis-Healthcare-Project\test_healthcare_dataset.csv
2025-05-19 21:30:34,242 - INFO - Processing chunk 1
2025-05-19 21:30:34,244 - INFO - Removed 0 duplicates
2025-05-19 21:30:34,246 - INFO - Handled missing values
2025-05-19 21:30:34,248 - INFO - Standardized formats
2025-05-19 21:30:34,249 - INFO - Validated data
2025-05-19 21:30:34,250 - INFO - Connected to database: healthcare.db
2025-05-19 21:30:34,252 - ERROR - Load failed: table healthcare has no column named Blood Type
2025-05-19 21:30:34,252 - ERROR - ETL pipeline failed: table healthcare has no column named Blood Type
2025-05-19 21:30:34,252 - INFO - Database connection closed
